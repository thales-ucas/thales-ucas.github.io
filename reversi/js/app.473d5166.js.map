{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/game.vue?57ce","webpack:///./src/components/game.vue?19e5","webpack:///./src/components/reversi/textures/square.jpg","webpack:///./src/app.vue","webpack:///./src/components/game.vue","webpack:///./src/components/reversi/square.js","webpack:///./src/components/reversi/engine.js","webpack:///./src/components/reversi/piece.js","webpack:///./src/components/reversi/board.js","webpack:///./src/components/reversi/roxanne.js","webpack:///./src/components/reversi/monte-carlo.js","webpack:///./src/components/reversi/ai-player.js","webpack:///./src/components/reversi/main.js","webpack:///./src/components/game.vue?15c7","webpack:///./src/app.vue?1c87","webpack:///./src/main.js","webpack:///./src/app.vue?615e","webpack:///./src/components/game.vue?3754","webpack:///./src/app.vue?9294","webpack:///./src/app.vue?45f8"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","___CSS_LOADER_API_IMPORT___","msg","class","ref","width","height","style","onGameClick","black","white","timeGlobal","player","timeLocal","onGameRestart","type","difficulty","onGameStart","isStartPanelShow","Square","_this","this","row","NaN","col","init","g","BoxGeometry","WIDTH","HEIGHT","TextureLoader","load","image","MeshBasicMaterial","color","map","Mesh","blink","position","y","constructor","Engine","param","_data","_current","shiftPlayer","CHESS","BLACK","WHITE","e","EVENT","SHIFT","dispatchEvent","legal","getLegal","getFilp","isValid","arr","opColor","direction","coord","xdirection","ydirection","x","parseInt","ROW","COL","getCount","counter","space","reset","clone","start","obj","moves","count","START","getData","getPlayer","getResult","diff","winner","WINNER","DRAW","isGameOver","event","GAME_OVER","move","flips","MOVE","isNaN","nears","dx","dy","NONE","findIndex","k","FLIP","assign","EventDispatcher","Piece","_color","geometry","CylinderGeometry","RADIUS","SEGMENT","materials","rotation","Math","PI","Promise","resolve","Tween","to","easing","Easing","Quadratic","In","onUpdate","onComplete","flip","delay","initX","up","down","spin","chain","Board","__bg","__chess","offset","Object3D","add","clear","hit","raycaster","intersects","intersectObjects","children","ret","pave","square","z","set","piece","list","getObjectByName","all","Roxanne","_table","sort","random","Simulator","engine","current","action","getMove","SimulatePlayer","roxnane","select","TreeNode","parent","w","node","MonteCarlo","expire","tick","Date","getTime","root","reject","sid","setInterval","simulateEngine","choice","expand","simulate","backScore","backProp","clearInterval","bestN","bestMove","bestScore","N","score","sqrt","log","child","setMove","simulator","run","mcts","AIPlayer","level","_mcts","_roxnane","_level","lv","getColor","think","then","res","setTimeout","RUNNING","GAME_INIT","GAME_START","GAME_STEP","main","container","X","Y","_canvas","CAMERA_FAR","__camera","__scene","__renderer","__board","_raycaster","_engine","_situation","_ai","_clock","Clock","_running","_enable","onResize","offsetLeft","offsetTop","clientWidth","clientHeight","onChessStart","onGameOver","stop","gameOver","onChessMove","onAIMove","animate","time","requestAnimationFrame","getElapsedTime","TWEEN","update","render","canvas","Scene","background","Color","PerspectiveCamera","WebGLRenderer","antialias","Raycaster","addEventListener","lookAt","removeAll","v","Vector3","copy","motion","setLength","click","vec","Vector2","setFromCamera","_time","_count","__reversi","mounted","$refs","onGameStep","onGameRunning","methods","hour","floor","minute","second","__scopeId","components","Game","designWidth","maxWidth","tid","rootItem","rootStyle","doc","document","win","docEl","documentElement","refreshRem","getBoundingClientRect","rem","getElementById","createElement","getElementsByTagName","appendChild","id","styleSheet","disabled","cssText","innerHTML","f","innerText","fontSize","clearTimeout","persisted","readyState","body","createApp","App","mount","content","locals","default"],"mappings":"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","file":"js/app.473d5166.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./game.vue?vue&type=style&index=0&id=42ff8356&scoped=true&lang=css\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"h3[data-v-42ff8356]{margin:40px 0 0}ul[data-v-42ff8356]{list-style-type:none;padding:0}li[data-v-42ff8356]{display:inline-block;margin:0 10px}a[data-v-42ff8356]{color:#42b983}.start-panel[data-v-42ff8356]{width:5rem;position:absolute;left:1.25rem;top:1.75rem;z-index:1;border-radius:.1rem;background-color:#fff}.start-panel .start-wrap[data-v-42ff8356]{margin:.3rem 1.5rem .7rem}.start-panel .start-wrap p[data-v-42ff8356]{text-align:left}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","module.exports = __webpack_public_path__ + \"img/square.40d3af04.jpg\";","<template>\n  <game msg=\"Welcome to Your Vue.js App\"/>\n</template>\n\n<script>\nimport Game from './components/game.vue';\n\nexport default {\n  name: 'App',\n  components: {\n    Game\n  }\n};\n(function(designWidth, maxWidth) {\n  var doc = document,\n    win = window;\n  var docEl = doc.documentElement;\n  var tid;\n  var rootItem,rootStyle;\n\n  function refreshRem() {\n    var width = docEl.getBoundingClientRect().width;\n    if (!maxWidth) {\n      maxWidth = 540;\n    }\n    if (width > maxWidth) {\n      width = maxWidth;\n    }\n    //与淘宝做法不同，直接采用简单的rem换算方法1rem=100px\n    var rem = width * 100 / designWidth;\n    //兼容UC开始\n    rootStyle=\"html{font-size:\"+rem+'px !important}';\n    rootItem = document.getElementById('rootsize') || document.createElement(\"style\");\n    if(!document.getElementById('rootsize')){\n    document.getElementsByTagName(\"head\")[0].appendChild(rootItem);\n    rootItem.id='rootsize';\n    }\n    if(rootItem.styleSheet){\n      rootItem.styleSheet.disabled||(rootItem.styleSheet.cssText=rootStyle);\n    }else{\n      try{rootItem.innerHTML=rootStyle;}catch(f){rootItem.innerText=rootStyle;}\n    }\n    //兼容UC结束\n    docEl.style.fontSize = rem + \"px\";\n  }\n  refreshRem();\n\n  win.addEventListener(\"resize\", function() {\n    clearTimeout(tid); //防止执行两次\n    tid = setTimeout(refreshRem, 300);\n  }, false);\n\n  win.addEventListener(\"pageshow\", function(e) {\n    if (e.persisted) { // 浏览器后退的时候重新计算\n      clearTimeout(tid);\n      tid = setTimeout(refreshRem, 300);\n    }\n  }, false);\n\n  if (doc.readyState === \"complete\") {\n    doc.body.style.fontSize = \"16px\";\n  } else {\n    doc.addEventListener(\"DOMContentLoaded\", function(e) {\n      doc.body.style.fontSize = \"16px\";\n    }, false);\n  }\n})(750, 750);\n</script>\n\n<style>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n</style>\n","<template>\n  <div class=\"game\">\n    <div>\n      <p>苹果棋</p>\n      <p>Reversi</p>\n    </div>\n    <div><canvas ref=\"game\" width=\"500\" height=\"500\" style=\"width:100%\" @click=\"onGameClick\"></canvas></div>\n    <div>\n      <ul>\n        <li><span>黑棋:</span><span>{{black}}</span></li>\n        <li><span>白棋:</span><span>{{white}}</span></li>\n      </ul>\n    </div>\n    <div>\n      总用时：{{timeGlobal}}\n    </div>\n    <div>\n      <span v-if=\"player===1\">黑棋思考中……</span>\n      <span v-else-if=\"player===2\">白棋思考中……</span>\n      <span>{{timeLocal}}秒</span>\n    </div>\n    <div v-if=\"msg\">\n      <p>{{msg}}</p>\n      <p><button @click=\"onGameRestart\">再玩一次</button></p>\n    </div>\n    <div v-show=\"isStartPanelShow\" class=\"start-panel\">\n      <div class=\"start-wrap\">\n        <p>\n          <label>\n            <input type=\"radio\" name=\"difficulty\" v-model=\"difficulty\" value=\"0\" /> 初级\n          </label>\n        </p>\n        <p>\n          <label>\n            <input type=\"radio\" name=\"difficulty\" v-model=\"difficulty\" value=\"1\" /> 中级\n          </label>\n        </p>\n        <p>\n          <label>\n            <input type=\"radio\" name=\"difficulty\" v-model=\"difficulty\" value=\"2\" /> 高级\n          </label>\n        </p>\n        <p>\n          <label>\n            <input type=\"radio\" name=\"difficulty\" v-model=\"difficulty\" value=\"10\" /> 双人对战\n          </label>\n        </p>\n        <button @click=\"onGameStart\">开始游戏</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport * as Reversi from \"./reversi/main\";\nexport default {\n  name: 'Game',\n  data() {\n    return {\n      isStartPanelShow: true,\n      difficulty: 0,\n      msg: \"1\",\n      timeGlobal: 0,\n      timeLocal: 0,\n      player: 0,\n      black: 0,\n      white: 0\n    };\n  },\n  _time: 0,\n  _count: 0,\n  __reversi: null,\n  mounted() {\n    this.__reversi = new Reversi.main(this.$refs['game']);\n    this.__reversi.addEventListener(Reversi.EVENT.GAME_STEP, this.onGameStep);\n    this.__reversi.addEventListener(Reversi.EVENT.RUNNING, this.onGameRunning);\n    this.__reversi.addEventListener(Reversi.EVENT.GAME_OVER, this.onGameOver);\n  },\n  methods: {\n    onGameClick(e) {\n      this.__reversi.click(e);\n    },\n    onGameStart(e) {\n      this.isStartPanelShow = false;\n      this.__reversi.start(this.difficulty);\n      this._count = this._time || 0;\n    },\n    onGameRestart(e) {\n      this.__reversi.reset();\n      this.isStartPanelShow = true;\n      this.msg = \"\";\n    },\n    onGameOver(e) {\n      const { black, white, space } = e.data;\n      if (black > white) {\n        this.msg = \"黑棋胜\";\n      } else if (white > black) {\n        this.msg = \"白棋胜\";\n      } else {\n        this.msg = \"平局\";\n      }\n    },\n    onGameRunning(e) {\n      const time = e.data;\n      this._time = time;\n      const hour = Math.floor(time / (60 * 60));\n      const minute = Math.floor((time / 60) % 60);\n      const second = Math.floor(time % 60);\n      this.timeGlobal = `${hour}小时 ${minute}分 ${second}秒`;\n      this.timeLocal = Math.floor(this._time - this._count);\n      if(this.timeLocal < 0) this.timeLocal = 0;\n    },\n    onGameStep(e) {\n      this._count = this._time || 0;\n      this.black = e.data.black;\n      this.white = e.data.white;\n      this.player = e.data.player;\n    }\n  }\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nh3 {\n  margin: 40px 0 0;\n}\nul {\n  list-style-type: none;\n  padding: 0;\n}\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\na {\n  color: #42b983;\n}\n.start-panel {\n  width: 5rem;\n  position: absolute;\n  left: 1.25rem;\n  top: 1.75rem;\n  z-index: 1;\n  border-radius: 0.1rem;\n  background-color: white;\n}\n.start-panel .start-wrap {\n  margin: 0.3rem 1.5rem 0.7rem;\n}\n.start-panel .start-wrap p {\n  text-align: left;\n}\n</style>\n","import { Mesh, BoxGeometry, MeshBasicMaterial, TextureLoader } from 'three';\r\nimport image from './textures/square.jpg';\r\n/**\r\n *\t方块\r\n */\r\nconst Square = function() {\r\n  const _this = this;\r\n  _this.row = NaN;\r\n  _this.col = NaN;\r\n\t/**\r\n\t *\t初始化\r\n\t */\r\n\t_this.init = () => {\r\n    const g = new BoxGeometry(Square.WIDTH, Square.HEIGHT, Square.WIDTH);\r\n    const t = new TextureLoader().load(image);\r\n    const m = new MeshBasicMaterial( { color: 0xffaa00, map: t } );\r\n    Mesh.call(_this, g, m);\r\n  };\r\n  _this.blink = () => {\r\n    _this.position.y += 5;\r\n  };\r\n\t_this.init();\r\n};\r\n\r\nSquare.WIDTH = 10;\r\nSquare.HEIGHT = 2;\r\n\r\nSquare.prototype = Object.create( Mesh.prototype );\r\nSquare.prototype.constructor = Square;\r\nexport default Square;","import { EventDispatcher } from 'three';\r\n/**\r\n *\t引擎\r\n */\r\nconst Engine = function(param) {\r\n  const _this = this;\r\n  let _data = null; // 棋盘数据\r\n  let _current = null; // 行动者\r\n  /**\r\n   *\t初始化\r\n   */\r\n  _this.init = function(data) {\r\n    if (data) {\r\n      _data = [];\r\n      for(let m = 0; m < Engine.ROW; m++) {\r\n        const arr = [];\r\n        for(let n = 0; n < Engine.COL; n++) {\r\n          arr.push(data[m][n]);\r\n        }\r\n        _data.push(arr);\r\n      }\r\n    } else {\r\n      _this.reset();\r\n    }\r\n  };\r\n  /**\r\n   * 克隆\r\n   * @returns {Engine} 新的引擎\r\n   */\r\n  _this.clone = () => new Engine(_data);\r\n  /**\r\n   * 复位\r\n   */\r\n  _this.reset = () => {\r\n    _data = [];\r\n    for(let m = 0; m < Engine.ROW; m++) {\r\n      const arr = [];\r\n      for(let n = 0; n < Engine.COL; n++) {\r\n        arr.push(0);\r\n      }\r\n      _data.push(arr);\r\n    }\r\n    _current = null;\r\n  };\r\n  /**\r\n   * 开始游戏\r\n   */\r\n  _this.start = () => {\r\n    const arr = [];\r\n    arr.push({row: 3, col: 4, color: Engine.CHESS.BLACK});\r\n    arr.push({row: 3, col: 3, color: Engine.CHESS.WHITE});\r\n    arr.push({row: 4, col: 3, color: Engine.CHESS.BLACK});\r\n    arr.push({row: 4, col: 4, color: Engine.CHESS.WHITE});\r\n    for(const obj of arr) {\r\n      const { row, col, color } = obj;\r\n      _data[row][col] = color;\r\n    }\r\n    shiftPlayer();\r\n    const data = {\r\n      moves: arr,\r\n      count: getCount()\r\n    };\r\n    const e = { type: Engine.EVENT.START, data };\r\n    _this.dispatchEvent(e);\r\n  };\r\n  /**\r\n   * 获取数据\r\n   */\r\n  _this.getData = () => {\r\n    return _data;\r\n  };\r\n  /**\r\n   * 换下一个颜色下棋\r\n   */\r\n  function shiftPlayer() {\r\n    if(!_current) {\r\n      _current = Engine.CHESS.BLACK;\r\n    } else {\r\n      _current = _current === Engine.CHESS.BLACK ? Engine.CHESS.WHITE : Engine.CHESS.BLACK;\r\n    }\r\n    const e = { type: Engine.EVENT.SHIFT, data: _current };\r\n    _this.dispatchEvent(e);\r\n    const legal = _this.getLegal(_current);\r\n    if(legal.length === 0) return shiftPlayer();\r\n    return _current;\r\n  }\r\n  /**\r\n   * 获得当前棋手\r\n   */\r\n  _this.getPlayer = () => _current;\r\n  /**\r\n   * 获取结果\r\n   */\r\n  _this.getResult = () => {\r\n    const count = getCount();\r\n    const diff = count.black - count.white;\r\n    let winner = Engine.WINNER.DRAW;\r\n    if(diff > 0) {\r\n      winner = Engine.WINNER.BLACK;\r\n    } else if(diff < 0) {\r\n      winner = Engine.WINNER.WHITE;\r\n    }\r\n    return { count, winner, diff };\r\n  };\r\n  /**\r\n   * 游戏检测\r\n   * @returns {boolean} 是否继续进行\r\n   */\r\n  _this.isGameOver = () => {\r\n    const count = getCount();\r\n    if (count.space === 0 || count.black === 0 || count.white === 0) {\r\n      const event = { type: Engine.EVENT.GAME_OVER, data: count};\r\n      _this.dispatchEvent(event);\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  };\r\n  /**\r\n   * 走棋\r\n   * @param {int} row 行\r\n   * @param {int} col 列\r\n   */\r\n  _this.move = (row, col) => {\r\n    const color = _current;\r\n    let flips  = getFilp(row, col, color);\r\n    if(flips) {\r\n      for(const obj of flips) {\r\n        _data[obj.row][obj.col] = color;\r\n      }\r\n    } else {\r\n      return;\r\n    }\r\n    _data[row][col] = color;\r\n    const count = getCount();\r\n    const data = { row, col, color, flips, count };\r\n    const e = { type: Engine.EVENT.MOVE, data };\r\n    _this.dispatchEvent(e); // 走棋\r\n    if(_this.isGameOver()) return;\r\n    shiftPlayer();\r\n  };\r\n  /**\r\n   * 获得可以翻的棋\r\n   * @param {int} row 行\r\n   * @param {int} col 列\r\n   * @param {int} color 颜色\r\n   */\r\n  function getFilp(row, col, color) {\r\n    if (_data[row][col] !== 0) {\r\n      return false;\r\n    }\r\n    if (!isValid(col, row)) {\r\n      return false;\r\n    }\r\n    _data[row][col] = color;\r\n    const arr = [];\r\n    const opColor = color === Engine.CHESS.BLACK ? Engine.CHESS.WHITE : Engine.CHESS.BLACK;\r\n    const direction = [[0, 1], [1, 1], [1, 0], [1, -1], [0, -1], [-1, -1], [-1, 0], [-1, 1]];\r\n    for(const coord of direction) {\r\n      const [ xdirection, ydirection ] = coord;\r\n      let x = parseInt(col);\r\n      let y = parseInt(row);\r\n      x += xdirection;\r\n      y += ydirection;\r\n      if(isValid(y, x) && _data[y][x] === opColor) {\r\n        do {\r\n          x += xdirection;\r\n          y += ydirection;  \r\n          if(!isValid(y, x)) break;\r\n        } while(_data[y][x] === opColor);\r\n      }\r\n      if(!isValid(y, x)) continue;\r\n      if(_data[y][x] === color) {\r\n        while (isValid(y, x)) {          \r\n          x -= xdirection;\r\n          y -= ydirection;\r\n          if (y == parseInt(row) && x == parseInt(col)) break;\r\n          arr.push({col:x, row:y});\r\n        }\r\n      }\r\n    }\r\n    _data[row][col] = 0;\r\n    if(arr.length === 0) return false;\r\n    return arr;\r\n  }\r\n  /**\r\n   * 获取合法点\r\n   * @param {emun} color 棋色\r\n   */\r\n  _this.getLegal = (color) => {\r\n    if(isNaN(color)) color = _current;\r\n    const direction = [[-1, 0], [-1, 1], [0, 1], [1, 1], [1, 0], [1, -1], [0, -1], [-1, -1]];\r\n    const opColor = color === Engine.CHESS.BLACK ? Engine.CHESS.WHITE : Engine.CHESS.BLACK;\r\n    const nears = [];\r\n    for(const m in _data) {\r\n      for(const n in _data[m]) {\r\n        if(_data[m][n] === opColor) {\r\n          for(const coord of direction) {\r\n            const [ dx, dy ] = coord;\r\n            let x = parseInt(n) + dx;\r\n            let y = parseInt(m) + dy;\r\n            if(isValid(y, x) && _data[y][x]=== Engine.CHESS.NONE\r\n            && nears.findIndex(k => k[0] === x && k[1] === y) === -1) {\r\n              nears.push([x, y]);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    const arr = [];\r\n    for(const coord of nears) {\r\n      if(getFilp(coord[1], coord[0], color)) {\r\n        arr.push(coord);\r\n      }\r\n    }\r\n    return arr;\r\n  };\r\n  /**\r\n   * 在棋盘上\r\n   * @param {int} row 行\r\n   * @param {int} col 列\r\n   */\r\n  function isValid( row, col ) {\r\n    return (row >= 0 && row <= Engine.ROW - 1 && col >= 0 && col <= Engine.COL - 1);\r\n  }\r\n  /**\r\n   * 获取统计\r\n   */\r\n  function getCount() {\r\n    const counter = {\r\n      black: 0,\r\n      white: 0,\r\n      space: 0\r\n    };\r\n    for(const row of _data) {\r\n      for(const col of row) {\r\n        if(col === Engine.CHESS.BLACK) {\r\n          counter.black++;\r\n        } else if(col === Engine.CHESS.WHITE) {\r\n          counter.white++;\r\n        } else {\r\n          counter.space++;\r\n        }\r\n      }\r\n    }\r\n    return counter;\r\n  }\r\n  _this.init(param);\r\n};\r\nEngine.ROW = 8;\r\nEngine.COL = 8;\r\nEngine.CHESS = {\r\n  NONE: 0,\r\n  BLACK: 1,\r\n  WHITE: 2\r\n};\r\nEngine.WINNER = {\r\n  DRAW: 0,\r\n  BLACK: 1,\r\n  WHITE: 2\r\n};\r\nEngine.EVENT = {\r\n  START: \"gameStart\", // 游戏开始\r\n  GAME_OVER: \"gameOver\", // 游戏结束\r\n  MOVE: \"chessMove\", // 走棋\r\n  SHIFT: \"playerShift\", // 旗手交换\r\n  FLIP: \"chessFlip\" // 棋子翻转\r\n};\r\n\r\nObject.assign( Engine.prototype, EventDispatcher.prototype );\r\nEngine.prototype.constructor = Engine;\r\nexport default Engine;","import { Mesh, CylinderGeometry, MeshBasicMaterial } from 'three';\r\nimport { Tween, Easing } from '@tweenjs/tween.js';\r\nimport Engine from './engine';\r\n/**\r\n *\t棋子\r\n */\r\nconst Piece = function(param) {\r\n  const _this = this;\r\n  let _color = null;\r\n\t/**\r\n\t *\t初始化\r\n\t */\r\n\t_this.init = (color) => {\r\n    const geometry = new CylinderGeometry(Piece.RADIUS, Piece.RADIUS, Piece.WIDTH, Piece.SEGMENT);\r\n    const materials = [\r\n      new MeshBasicMaterial( { color: \"red\" } ),\r\n      new MeshBasicMaterial( { color: \"black\" } ),\r\n      new MeshBasicMaterial( { color: \"white\" } )\r\n    ];\r\n    Mesh.call(_this, geometry, materials);\r\n    _color = parseInt(color);\r\n    if(_color == Engine.CHESS.WHITE) {\r\n      _this.rotation.x = Math.PI;\r\n    }\r\n  };\r\n  /**\r\n   * 走棋\r\n   */\r\n  _this.move = () => {\r\n    return new Promise((resolve) => {\r\n      let coord = { y: 10 };\r\n      const t = new Tween(coord).to({y:0}, 500).easing(Easing.Quadratic.In);\r\n      t.onUpdate((e) => {_this.position.y = e.y;});\r\n      t.onComplete(e => {resolve(e);});\r\n      t.start();\r\n    });\r\n  };\r\n  /**\r\n   * 翻转\r\n   * @param {int} delay 延迟\r\n   */\r\n  _this.flip = (delay = 0) => {\r\n    return new Promise((resolve) => {\r\n      let rotation = { x: 0 };\r\n      _color = _color == Engine.CHESS.WHITE ? Engine.CHESS.BLACK : Engine.CHESS.WHITE;\r\n      const initX = _this.rotation.x;\r\n      let coord = { y: 0 };\r\n      const up = new Tween(coord).to({y: 10}, 300).onUpdate((e) => {_this.position.y = e.y;});\r\n      const down = new Tween(coord).to({y: 0}, 200).onUpdate((e) => {_this.position.y = e.y;});\r\n      const spin = new Tween(rotation).to({x: Math.PI}, 300).onUpdate((e) => {_this.rotation.x = initX + e.x;});\r\n      spin.onComplete(e => {resolve(e);});\r\n      spin.chain(down);\r\n      up.chain(spin);\r\n      up.delay(delay);\r\n      up.start();\r\n    });\r\n  };\r\n\t_this.init(param);\r\n};\r\n\r\nPiece.RADIUS = 4;\r\nPiece.HEIGHT = 1;\r\nPiece.SEGMENT = 20;\r\n\r\nPiece.prototype = Object.create( Mesh.prototype );\r\nPiece.prototype.constructor = Piece;\r\nexport default Piece;","import { Object3D } from 'three';\r\nimport Square from './square';\r\nimport Piece from './piece';\r\n\r\n/**\r\n *\t棋盘\r\n */\r\nconst Board = function() {\r\n  const _this = this;\r\n  let __bg = null, // 背景\r\n    __chess = null; // 棋子\r\n  _this.offset = { // 偏移位置\r\n    row: 0,\r\n    col: 0,\r\n  };\r\n\t/**\r\n\t *\t初始化\r\n\t */\r\n\t_this.init = () => {\r\n    Object3D.call(_this);\r\n    __bg = new Object3D();\r\n    __chess = new Object3D();\r\n    _this.add(__bg, __chess);\r\n  };\r\n  /**\r\n   * 重置\r\n   */\r\n  _this.reset = () => {\r\n    __chess.clear();\r\n  };\r\n  /**\r\n   * 触碰\r\n   * @param {raycaster} raycaster 射线\r\n   */\r\n  _this.hit = raycaster => {\r\n    const intersects = raycaster.intersectObjects( __bg.children );\r\n    let ret = null;\r\n    if(intersects.length > 0) {\r\n      ret = intersects[0];\r\n    }\r\n    return ret;\r\n  };\r\n  /**\r\n   * 铺路\r\n   */\r\n  _this.pave = (data) => {\r\n    __bg.clear();\r\n    _this.offset.row = data.length / 2 * Square.WIDTH - Square.WIDTH / 2;\r\n    _this.offset.col = _this.offset.row;\r\n    for ( const m in data ) {\r\n      for ( const n in data[m] ) {\r\n        const square = new Square();\r\n        square.row = m;\r\n        square.col = n;\r\n        square.position.x = n * Square.WIDTH;\r\n        square.position.z = m * Square.WIDTH;\r\n        __bg.add(square);\r\n      }\r\n    }\r\n    __bg.position.set(-_this.offset.col, 0, -_this.offset.row);\r\n    __chess.position.set(-_this.offset.col, Square.HEIGHT, -_this.offset.row);\r\n  };\r\n  /**\r\n   * 走棋\r\n   * @param {int} row 行\r\n   * @param {int} col 列\r\n   * @param {int} color 颜色\r\n   */\r\n  _this.move = (row, col, color) => {\r\n    const piece = new Piece(color);\r\n    piece.position.x = col * Square.WIDTH;\r\n    piece.position.z = row * Square.WIDTH;\r\n    piece.name = `${row}-${col}`;\r\n    __chess.add(piece);\r\n    return piece.move();\r\n  };\r\n  /**\r\n   * 翻转\r\n   * @param {array} arr \r\n   */\r\n  _this.flip = (arr) => {\r\n    const list = [];\r\n    if (arr) {\r\n      for(const k in arr) {\r\n        const { row, col } = arr[k];\r\n        const piece = __chess.getObjectByName(`${row}-${col}`);\r\n        list.push(piece.flip(parseInt(k) * 500));\r\n      }\r\n    }\r\n    return Promise.all(list);\r\n  };\r\n\t_this.init();\r\n};\r\n\r\nBoard.prototype = Object.create( Object3D.prototype );\r\nBoard.prototype.constructor = Board;\r\nexport default Board;","/**\r\n * Roxanne 策略 详见 《Analysis of Monte Carlo Techniques in Othello》 \r\n * 提出者：Canosa, R. Roxanne canosa homepage. https://www.cs.rit.edu/~rlc/ \r\n */\r\nclass Roxanne {\r\n  constructor() {\r\n    this._table = [\r\n      [ [0, 0], [0, 7], [7, 0], [7, 7] ],\r\n      [ [2, 2], [2, 5], [5, 2], [5, 5] ],\r\n      [ [3, 2], [3, 5], [4, 2], [4, 5], [2, 3], [2, 4], [5, 3], [5, 4] ],\r\n      [ [2, 0], [2, 7], [5, 0], [5, 7], [0, 2], [0, 5], [7, 2], [7, 5] ],\r\n      [ [3, 0], [3, 7], [4, 0], [4, 7], [0, 3], [0, 4], [7, 3], [7, 4] ],\r\n      [ [2, 1], [2, 6], [5, 1], [5, 6], [1, 2], [1, 5], [6, 2], [6, 5] ],\r\n      [ [3, 1], [3, 6], [4, 1], [4, 6], [1, 3], [1, 4], [6, 3], [6, 4] ],\r\n      [ [1, 1], [1, 6], [6, 1], [6, 6] ],\r\n      [ [1, 0], [1, 7], [6, 0], [6, 7], [0, 1], [0, 6], [7, 1], [7, 6]]\r\n    ];\r\n  }\r\n  select(arr) {\r\n    if (arr && arr.length > 0) {\r\n      for(const moves of this._table) {\r\n        moves.sort(() => 0.5 - Math.random());\r\n        for(const move of moves) {\r\n          if(arr.findIndex(n => n[0] === move[0] && n[1] === move[1]) > -1) {\r\n            return move;\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n}\r\nexport default Roxanne;","import Engine from \"./engine\";\r\nimport Roxanne from \"./roxanne\";\r\n\r\n/**\r\n * 模拟器\r\n */\r\nclass Simulator {\r\n  /**\r\n   * 构造\r\n   * @param {Player} black 黑棋模拟选手\r\n   * @param {Player} white 白棋模拟选手\r\n   * @param {Engine} engine 引擎\r\n   * @param {int} current 现在棋手\r\n   */\r\n  constructor(black, white, engine, current) {\r\n    this.black = black;\r\n    this.white = white;\r\n    this.current = current;\r\n    this.engine = engine;\r\n  }\r\n  run() {\r\n    let n = 0;\r\n    while(!this.engine.isGameOver()) {\r\n      this.shift();\r\n      const arr = this.engine.getLegal(this.current.color);\r\n      if(arr && arr.length > 0) {\r\n        const action = this.current.getMove(arr);\r\n        this.engine.move(action[1], action[0]);  \r\n      }\r\n      if(n >100)\r\n        break;\r\n      else\r\n        n++;\r\n    }\r\n    return this.engine.getResult();\r\n  }\r\n  /**\r\n   * 设置current玩家\r\n   */\r\n  shift() {\r\n    const color = this.engine.getPlayer();\r\n    if(isNaN(color)) {\r\n      this.current = this.black;\r\n    } else {\r\n      this.current = color === Engine.CHESS.BLACK ? this.black : this.white;\r\n    }\r\n    return this.current;\r\n  }\r\n}\r\n/**\r\n * 模拟玩家\r\n * @param {int} color 颜色\r\n */\r\nclass SimulatePlayer {\r\n  /**\r\n   * \r\n   * @param {enum} color 颜色\r\n   * @param {enum} type 类型\r\n   */\r\n  constructor(color, type) {\r\n    this.color = color;\r\n    this.type = type;\r\n    this.roxnane = new Roxanne();\r\n  }\r\n  /**\r\n   * 走棋\r\n   * @param {Array} arr 可以走的位置\r\n   * @returns 走棋步骤[col, row]\r\n   */\r\n  getMove(arr) {\r\n    return this.roxnane.select(arr);\r\n  }\r\n}\r\n/**\r\n * 梦特卡洛树\r\n */\r\nclass TreeNode {\r\n  constructor(parent, color) {\r\n    this.parent = parent;\r\n    this.w = 0;\r\n    this.n = 0;\r\n    this.row = NaN;\r\n    this.col = NaN;\r\n    this.color = color;\r\n    this.children = [];\r\n  }\r\n  /**\r\n   * 设置走棋步骤\r\n   * @param {array} move [col, row]\r\n   */\r\n  setMove(move) {\r\n    this.row = move[1];\r\n    this.col = move[0];\r\n  }\r\n  /**\r\n   * 获得走棋步骤\r\n   */\r\n  getMove() {\r\n    return [this.col, this.row];\r\n  }\r\n  /**\r\n   * 添加节点，去重\r\n   * @param {TreeNode} node 蒙特卡洛树节点\r\n   */\r\n  add(node) {\r\n    if(this.children.findIndex(p => p.row === node.row && p.col === node.col) === -1) {\r\n      this.children.push(node);\r\n    }\r\n  }\r\n}\r\n/**\r\n * 梦特卡洛算法\r\n * @param {int} color 颜色\r\n * @param {int} expire 限时\r\n */\r\nclass MonteCarlo {\r\n  constructor(color, expire = 2000) {\r\n    this.color = color;\r\n    this.expire = expire;\r\n    this.tick = 0;\r\n    this.black = new SimulatePlayer(Engine.CHESS.BLACK);\r\n    this.white = new SimulatePlayer(Engine.CHESS.WHITE);\r\n  }\r\n  /**\r\n   * 运行\r\n   * @param {Engine} engine 引擎\r\n   */\r\n  run(engine) {\r\n    this.tick = new Date().getTime();\r\n    const root = new TreeNode(null, this.color);\r\n    return new Promise((resolve, reject) => {\r\n      const sid = setInterval(() => {\r\n        const simulateEngine = engine.clone();\r\n        const choice = this.select(root, simulateEngine);\r\n        this.expand(choice, simulateEngine);\r\n        const {winner} = this.simulate(choice, simulateEngine);\r\n        let backScore = [0.5, 1, 0][winner];\r\n        if (choice.color === Engine.CHESS.BLACK) {\r\n          backScore = 1 - backScore;\r\n        }\r\n        this.backProp(choice, backScore);\r\n        if(new Date().getTime() - this.tick > this.expire - 1) {\r\n          clearInterval(sid);\r\n          let bestN = -1;\r\n          let bestMove = null;\r\n          for(const k in root.children) {\r\n            if(root.children[k].n > bestN) {\r\n              bestN = root.children[k].n;\r\n              bestMove = root.children[k].getMove();\r\n            }\r\n          }      \r\n          resolve(bestMove);\r\n        }\r\n      }, 1);\r\n  \r\n    });\r\n  }\r\n  /**\r\n   * 蒙特卡洛树搜索，节点选择\r\n   * @param {TreeNode} node 节点\r\n   * @param {Engine} engine 引擎\r\n   * @returns 搜索树向下递归选择子节点\r\n   */\r\n  select(node, engine) {\r\n    if (node.children.length === 0) {\r\n      return node;\r\n    } else {\r\n      let bestScore = -1;\r\n      let bestMove = null;\r\n      for (const k in node.children) {\r\n        if (node.children[k].n === 0) {\r\n          bestMove = k;\r\n          break;\r\n        } else {\r\n          let N = node.n;\r\n          let n = node.children[k].n;\r\n          let w = node.children[k].w;\r\n          const score = w / n + Math.sqrt(2 * Math.log(N) / n);\r\n          if (score > bestScore) {\r\n            bestScore = score;\r\n            bestMove = k;\r\n          }\r\n        }\r\n      }\r\n      return this.select(node.children[bestMove], engine);\r\n    }\r\n  }\r\n  /**\r\n   * 蒙特卡洛树搜索，节点扩展\r\n   * @param {TreeNode} node 节点\r\n   * @param {Engine} engine 引擎\r\n   * @returns 搜索树向下递归选择子节点\r\n   */\r\n  expand(node, engine) {\r\n    for (const move of engine.getLegal(node.color)) {\r\n      const child = new TreeNode(node, node.color);\r\n      child.setMove(move);\r\n      node.add(child);\r\n    }\r\n  }\r\n  /**\r\n   * 蒙特卡洛树搜索，采用Roxanne策略代替随机策略搜索，模拟扩展搜索树\r\n   * @param {TreeNode} node 节点\r\n   * @param {Engine} engine 引擎\r\n   */\r\n  simulate(node, engine) {\r\n    const current = node.color === Engine.CHESS.WHITE ? Engine.CHESS.BLACK : Engine.CHESS.WHITE;\r\n    const simulator = new Simulator(this.black, this.white, engine, current);\r\n    return simulator.run();\r\n  }\r\n  /**\r\n   * 蒙特卡洛树搜索，反向传播，回溯更新模拟路径中的节点奖励\r\n   * @param {TreeNode} node 节点\r\n   * @param {int} score 计分\r\n   */\r\n  backProp(node, score) {\r\n    node.n += 1;\r\n    node.w += score;\r\n    if (node.parent) {\r\n      this.backProp(node.parent, 1 - score);\r\n    } \r\n  }\r\n  /**\r\n   * 蒙特卡洛树搜索\r\n   * @param {Engine} engine 引擎\r\n   * @returns 采取最佳拓展落子策略\r\n   */\r\n  getMove(engine) {\r\n    this.tick = new Date().getTime();\r\n    const action = this.mcts(engine.clone());\r\n    return action;\r\n  }\r\n}\r\nexport default MonteCarlo;","import { EventDispatcher } from 'three';\r\nimport Engine from './engine';\r\nimport MonteCarlo from './monte-carlo';\r\nimport Roxanne from './roxanne';\r\n\r\n/**\r\n *\t电脑玩家\r\n */\r\nconst AIPlayer = function(level) {\r\n  const _this = this;\r\n  let _mcts = null;\r\n  let _roxnane = null;\r\n  let _level = 0; // 游戏等级\r\n\t/**\r\n\t *\t初始化\r\n\t */\r\n\t_this.init = (lv) => {\r\n    _mcts = new MonteCarlo(Engine.CHESS.WHITE);\r\n    _roxnane = new Roxanne();\r\n    _level = parseInt(lv);\r\n  };\r\n  /**\r\n   * 获取棋色\r\n   */\r\n  _this.getColor = () => {\r\n    return Engine.CHESS.WHITE;\r\n  };\r\n  /**\r\n   * 思考\r\n   * @param {Engine} engine 引擎\r\n   */\r\n  _this.think = (engine) => {\r\n    if(_level === 2) {\r\n      _mcts.run(engine).then(res => {\r\n        const [ col, row ] = res;\r\n        const data = { col, row, color: _this.getColor() };\r\n        const e = { type: AIPlayer.EVENT.MOVE, data };\r\n        _this.dispatchEvent(e);\r\n      });\r\n    } else {\r\n      const arr = engine.getLegal();\r\n      if(arr.length === 0) return;\r\n      let col, row;\r\n      if(_level === 1) {\r\n        [ col, row ] = _roxnane.select(arr);\r\n      } else {\r\n        [ col, row ] = arr[parseInt(Math.random() * arr.length)];\r\n      }\r\n      const data = { col, row, color: _this.getColor() };\r\n      setTimeout(() => {\r\n        const e = { type: AIPlayer.EVENT.MOVE, data };\r\n        _this.dispatchEvent(e);        \r\n      }, 500);  \r\n    }\r\n  };\r\n\t_this.init(level);\r\n};\r\n\r\nAIPlayer.EVENT = {\r\n  MOVE: \"aiPlayerMove\"\r\n};\r\n\r\n\r\nAIPlayer.prototype = Object.create( EventDispatcher.prototype );\r\nAIPlayer.prototype.constructor = AIPlayer;\r\nexport default AIPlayer;","import { WebGLRenderer, EventDispatcher, PerspectiveCamera, Scene, Color, Raycaster, Vector2, Vector3, Clock } from 'three';\r\nimport TWEEN, { Tween } from '@tweenjs/tween.js';\r\nimport Board from './board';\r\nimport Engine from './engine';\r\nimport AIPlayer from './ai-player';\r\n/**\r\n *\t版本\r\n */\r\nconst VER = \"1.0\";\r\n/**\r\n *\t事件\r\n */\r\nconst EVENT = {\r\n  RUNNING:\t\"running\",\r\n  GAME_INIT: \"gameInit\",\r\n  GAME_START:\t\"gameStart\",\r\n  GAME_STEP: \"gameStep\",\r\n  GAME_OVER:\t\"gameOver\"\r\n};\r\n/**\r\n * 主函数\r\n * @param {canvas} container canvas元素\r\n */\r\nconst main = function(container){\r\n  const _this = this;\r\n  \r\n  let X = 0,\r\n    Y = 0,\r\n    WIDTH = 0,\r\n    HEIGHT = 0;\r\n  let _canvas = null;\r\n  \r\n  const CAMERA_FAR = 60; // 摄像头距离\r\n  let __camera = null,\t//摄像头\r\n    __scene = null,\t//场景\r\n    __renderer = null,\t//渲染器\r\n    __board = null;\t//棋盘\r\n  let _raycaster = null, // 射线\r\n    _engine = null, // 游戏引擎\r\n    _situation = {}, // 对阵局势\r\n    _ai = null, // 电脑玩家\r\n    _clock = new Clock, // 时钟\r\n    _running = false, // 游戏运行中\r\n    _enable = false; // 激活状态\r\n  /**\r\n   *\t初始化\r\n   */\r\n  _this.init = function(canvas) {\r\n    _canvas = canvas;\r\n    onResize();\r\n    __scene = new Scene();\r\n    __scene.background = new Color( 'skyblue' );\r\n    __camera = new PerspectiveCamera( 75, WIDTH / HEIGHT, 1, 1000 );\r\n    __camera.position.set(0, 0, CAMERA_FAR);\r\n    __renderer = new WebGLRenderer({canvas, antialias: true});\r\n    _raycaster = new Raycaster();\r\n    _engine = new Engine();\r\n    _engine.addEventListener( Engine.EVENT.START, onChessStart );\r\n    _engine.addEventListener( Engine.EVENT.GAME_OVER, onGameOver );\r\n    _engine.addEventListener( Engine.EVENT.MOVE, onChessMove );\r\n    __board = new Board();\r\n    __board.pave(_engine.getData());\r\n    __scene.add( __board );\r\n    __camera.lookAt(__board.position);\r\n    window.addEventListener(\"resize\", onResize);\r\n    animate(0);\r\n  };\r\n  /**\r\n   * 尺寸重置\r\n   */\r\n  function onResize() {\r\n    X = _canvas.offsetLeft;\r\n    Y = _canvas.offsetTop;\r\n    WIDTH = _canvas.clientWidth;\r\n    HEIGHT = _canvas.clientHeight;\r\n  }\r\n  /**\r\n   * 重置\r\n   */\r\n  _this.reset = () => {\r\n    _engine.reset();\r\n    __board.reset();\r\n    _enable = false;\r\n    _running = false;\r\n    TWEEN.removeAll();\r\n  };\r\n  /**\r\n   * 游戏开始\r\n   * @param {int} level 电脑等级\r\n   */\r\n  _this.start = (level) => {\r\n    onResize(); // 必须重新定位，否则高度不正确\r\n    let v = new Vector3();\r\n    v.copy(__camera.position);\r\n    const motion = new Vector3();\r\n    const t = new Tween(v).to({x: 0, y: CAMERA_FAR, z: 0}); // 摄像机动画\r\n    t.onUpdate(e => {\r\n      motion.copy(e);\r\n      motion.setLength(CAMERA_FAR);\r\n      __camera.position.copy(motion);\r\n      __camera.lookAt(__board.position);\r\n    });\r\n    t.onComplete(() => {\r\n      if(parseInt(level ) === 10) {\r\n        _situation[Engine.CHESS.WHITE] = 'player';\r\n      }else{\r\n        _ai = new AIPlayer(level);\r\n        _ai.addEventListener( AIPlayer.EVENT.MOVE, onAIMove );  \r\n        _situation[Engine.CHESS.WHITE] = 'ai';\r\n      }\r\n      _situation[Engine.CHESS.BLACK] = 'player';\r\n      _engine.start();\r\n    });\r\n    t.start();\r\n  };\r\n  /**\r\n   * 点击\r\n   * @param {event} e\r\n   */\r\n  _this.click = (e) => {\r\n    if (!_enable) return; // 允许玩家走时候才能操作\r\n    const vec = new Vector2();\r\n    const x = e.x - X;\r\n    const y = e.y - Y;\r\n    vec.x = ( x / WIDTH ) * 2 - 1;\r\n    vec.y = - ( y / HEIGHT ) * 2 + 1;\r\n    _raycaster.setFromCamera( vec, __camera ); // 根据摄像头引射线\r\n    const ret = __board.hit(_raycaster); // 射线触碰决定用户点击的位置\r\n    if (ret) { // 玩家走棋\r\n      const { row, col } = ret.object;\r\n      _engine.move(row, col);\r\n    }\r\n  };\r\n  /**\r\n   * 交换操作者\r\n   */\r\n  function shiftPlayer() {\r\n    const current = _engine.getPlayer();\r\n    if (_situation[current] === \"player\") {\r\n      _enable = true;\r\n    } else if (_situation[current] === \"ai\") {\r\n      _ai.think(_engine);\r\n    }\r\n  }\r\n  /**\r\n   * 游戏开始\r\n   * @param {event} e \r\n   */\r\n  async function onChessStart(e) {\r\n    const { count, moves } = e.data;\r\n    const start = new Date().getTime();\r\n    for(const obj of moves) {\r\n      const { row, col, color } = obj;\r\n      await __board.move(row, col, color);\r\n    }\r\n    _enable = true;\r\n    _running = true;\r\n    _clock.start();\r\n    count.player = _engine.getPlayer();\r\n    const event = { type: EVENT.GAME_STEP, data: count};\r\n    _this.dispatchEvent(event);\r\n  }\r\n  /**\r\n   * 游戏结束\r\n   * @param {event} e \r\n   */\r\n  function onGameOver(e) {\r\n    _running = false;\r\n    _clock.stop();\r\n  }\r\n  /**\r\n   * 游戏检测\r\n   * @param {object} count 统计信息\r\n   * @returns {boolean} 是否继续进行\r\n   */\r\n  function gameOver(count) {\r\n    const event = { type: EVENT.GAME_OVER, data: count};\r\n    _this.dispatchEvent(event);\r\n  }\r\n  /**\r\n   * 走棋\r\n   * @param {event} e \r\n   */\r\n  function onChessMove(e) {\r\n    _enable = false;\r\n    const { row, col, color, flips, count } = e.data;\r\n    __board.move( row, col, color ).then(() => {\r\n      __board.flip(flips).then(() => {\r\n        count.player = _engine.getPlayer();\r\n        const event = { type: EVENT.GAME_STEP, data: count};\r\n        _this.dispatchEvent(event);\r\n        if(_running) {\r\n          shiftPlayer(); // 交换棋手\r\n        } else {\r\n          gameOver(count);\r\n        }\r\n      });\r\n    });\r\n  }\r\n  /**\r\n   * 电脑走棋\r\n   * @param {event} e \r\n   */\r\n  function onAIMove(e) {\r\n    const { row, col } = e.data;\r\n    _engine.move(row, col);\r\n  }\r\n  function animate(time) {\r\n    requestAnimationFrame( animate );\r\n    if(_running) {\r\n      const event = { type: EVENT.RUNNING, data: _clock.getElapsedTime()};\r\n      _this.dispatchEvent(event);\r\n    }\r\n    TWEEN.update(time);\r\n    __renderer.render( __scene, __camera );\r\n  }\r\n  _this.init(container);\r\n};\r\n\r\nObject.assign( main.prototype, EventDispatcher.prototype);\r\nmain.prototype.constructor = main;\r\nexport {main, VER, EVENT};","import { render } from \"./game.vue?vue&type=template&id=42ff8356&scoped=true\"\nimport script from \"./game.vue?vue&type=script&lang=js\"\nexport * from \"./game.vue?vue&type=script&lang=js\"\n\nimport \"./game.vue?vue&type=style&index=0&id=42ff8356&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-42ff8356\"\n\nexport default script","import { render } from \"./app.vue?vue&type=template&id=71563f97\"\nimport script from \"./app.vue?vue&type=script&lang=js\"\nexport * from \"./app.vue?vue&type=script&lang=js\"\n\nimport \"./app.vue?vue&type=style&index=0&id=71563f97&lang=css\"\nscript.render = render\n\nexport default script","import { createApp } from 'vue';\nimport App from './app.vue';\n\ncreateApp(App).mount('#app');\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"#app{font-family:Avenir,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-align:center;color:#2c3e50}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./game.vue?vue&type=style&index=0&id=42ff8356&scoped=true&lang=css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"2c4d5be2\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","export * from \"-!../node_modules/vue-style-loader/index.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./app.vue?vue&type=style&index=0&id=71563f97&lang=css\"","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./app.vue?vue&type=style&index=0&id=71563f97&lang=css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"dee7462c\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"sourceRoot":""}