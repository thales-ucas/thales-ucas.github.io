{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/game.vue?b6ea","webpack:///./src/components/reversi/textures/square.jpg","webpack:///./src/app.vue","webpack:///./src/components/game.vue","webpack:///./src/components/reversi/square.js","webpack:///./src/components/reversi/engine.js","webpack:///./src/components/reversi/piece.js","webpack:///./src/components/reversi/board.js","webpack:///./src/components/reversi/roxanne.js","webpack:///./src/components/reversi/monte-carlo.js","webpack:///./src/components/reversi/ai-player.js","webpack:///./src/components/reversi/main.js","webpack:///./src/components/game.vue?d40c","webpack:///./src/app.vue?63b4","webpack:///./src/main.js","webpack:///./src/app.vue?d444","webpack:///./src/components/game.vue?6355","webpack:///./src/components/game.vue?d48c","webpack:///./src/app.vue?4f11","webpack:///./src/app.vue?bcef"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","content","default","locals","add","_createBlock","_component_game","msg","class","_createElementVNode","_createElementBlock","_hoisted_2","ref","width","height","onClick","$options","_hoisted_3","_toDisplayString","$data","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","type","$event","Square","_this","this","row","NaN","col","init","g","BoxGeometry","WIDTH","HEIGHT","TextureLoader","load","image","MeshBasicMaterial","color","map","Mesh","blink","position","y","constructor","Engine","param","_data","_current","shiftPlayer","CHESS","BLACK","WHITE","e","EVENT","SHIFT","dispatchEvent","legal","getLegal","getFilp","isValid","arr","opColor","direction","coord","xdirection","ydirection","x","parseInt","ROW","COL","getCount","counter","black","white","space","reset","clone","start","obj","moves","count","START","getData","getPlayer","getResult","diff","winner","WINNER","DRAW","isGameOver","event","GAME_OVER","move","flips","MOVE","isNaN","nears","dx","dy","NONE","findIndex","k","FLIP","assign","EventDispatcher","Piece","_color","geometry","CylinderGeometry","RADIUS","SEGMENT","materials","rotation","Math","PI","Promise","resolve","Tween","to","easing","Easing","Quadratic","In","onUpdate","onComplete","flip","delay","initX","up","down","spin","chain","Board","__bg","__chess","offset","Object3D","clear","hit","raycaster","intersects","intersectObjects","children","ret","pave","square","z","set","pave2","visible","onStart","piece","list","getObjectByName","all","Roxanne","_table","sort","random","Simulator","engine","current","action","getMove","SimulatePlayer","roxnane","select","TreeNode","parent","w","node","MonteCarlo","expire","tick","Date","getTime","root","reject","sid","setInterval","simulateEngine","choice","expand","simulate","backScore","backProp","clearInterval","bestN","bestMove","bestScore","N","score","sqrt","log","child","setMove","simulator","run","mcts","AIPlayer","level","_mcts","_roxnane","_level","lv","getColor","think","then","res","setTimeout","RUNNING","GAME_INIT","GAME_START","GAME_STEP","main","container","X","Y","_canvas","CAMERA_FAR","__camera","__scene","__renderer","__board","_raycaster","_engine","_situation","_ai","_clock","Clock","_running","_enable","onResize","offsetLeft","offsetTop","clientWidth","clientHeight","onChessStart","player","onGameOver","stop","gameOver","onChessMove","onAIMove","animate","time","requestAnimationFrame","getElapsedTime","TWEEN","update","render","canvas","Scene","background","Color","PerspectiveCamera","WebGLRenderer","antialias","Raycaster","addEventListener","lookAt","removeAll","v","Vector3","copy","motion","setLength","test","controls","OrbitControls","domElement","click","vec","Vector2","setFromCamera","isStartPanelShow","difficulty","timeGlobal","timeLocal","_time","_count","__reversi","mounted","Reversi","$refs","onGameStep","onGameRunning","methods","onGameClick","onGameStart","onGameRestart","hour","floor","minute","second","__exports__","components","Game","designWidth","maxWidth","tid","rootItem","rootStyle","doc","document","win","docEl","documentElement","refreshRem","getBoundingClientRect","rem","getElementById","createElement","getElementsByTagName","appendChild","id","styleSheet","disabled","cssText","innerHTML","f","innerText","style","fontSize","clearTimeout","persisted","readyState","body","createApp","App","mount","___CSS_LOADER_API_IMPORT___"],"mappings":"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","file":"js/app.1981ca89.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./game.vue?vue&type=style&index=0&id=4f0d16f2&scoped=true&lang=css\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"d1104f7c\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","module.exports = __webpack_public_path__ + \"img/square.40d3af04.jpg\";","<template>\r\n  <game msg=\"Welcome to Your Vue.js App\"/>\r\n</template>\r\n\r\n<script>\r\nimport Game from './components/game.vue';\r\n\r\nexport default {\r\n  name: 'App',\r\n  components: {\r\n    Game\r\n  }\r\n};\r\n(function(designWidth, maxWidth) {\r\n  var doc = document,\r\n    win = window;\r\n  var docEl = doc.documentElement;\r\n  var tid;\r\n  var rootItem,rootStyle;\r\n\r\n  function refreshRem() {\r\n    var width = docEl.getBoundingClientRect().width;\r\n    if (!maxWidth) {\r\n      maxWidth = 540;\r\n    }\r\n    if (width > maxWidth) {\r\n      width = maxWidth;\r\n    }\r\n    //与淘宝做法不同，直接采用简单的rem换算方法1rem=100px\r\n    var rem = width * 100 / designWidth;\r\n    //兼容UC开始\r\n    rootStyle=\"html{font-size:\"+rem+'px !important}';\r\n    rootItem = document.getElementById('rootsize') || document.createElement(\"style\");\r\n    if(!document.getElementById('rootsize')){\r\n    document.getElementsByTagName(\"head\")[0].appendChild(rootItem);\r\n    rootItem.id='rootsize';\r\n    }\r\n    if(rootItem.styleSheet){\r\n      rootItem.styleSheet.disabled||(rootItem.styleSheet.cssText=rootStyle);\r\n    }else{\r\n      try{rootItem.innerHTML=rootStyle;}catch(f){rootItem.innerText=rootStyle;}\r\n    }\r\n    //兼容UC结束\r\n    docEl.style.fontSize = rem + \"px\";\r\n  }\r\n  refreshRem();\r\n\r\n  win.addEventListener(\"resize\", function() {\r\n    clearTimeout(tid); //防止执行两次\r\n    tid = setTimeout(refreshRem, 300);\r\n  }, false);\r\n\r\n  win.addEventListener(\"pageshow\", function(e) {\r\n    if (e.persisted) { // 浏览器后退的时候重新计算\r\n      clearTimeout(tid);\r\n      tid = setTimeout(refreshRem, 300);\r\n    }\r\n  }, false);\r\n\r\n  if (doc.readyState === \"complete\") {\r\n    doc.body.style.fontSize = \"16px\";\r\n  } else {\r\n    doc.addEventListener(\"DOMContentLoaded\", function(e) {\r\n      doc.body.style.fontSize = \"16px\";\r\n    }, false);\r\n  }\r\n})(750, 750);\r\n</script>\r\n\r\n<style>\r\n#app {\r\n  font-family: Avenir, Helvetica, Arial, sans-serif;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n  text-align: center;\r\n  color: #2c3e50;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"game\">\r\n    <div>\r\n      <p>苹果棋</p>\r\n      <p>Reversi</p>\r\n    </div>\r\n    <div><canvas ref=\"game\" width=\"500\" height=\"500\" class=\"container\" @click=\"onGameClick\"></canvas></div>\r\n    <div>\r\n      <ul>\r\n        <li><span>黑棋:</span><span>{{black}}</span></li>\r\n        <li><span>白棋:</span><span>{{white}}</span></li>\r\n      </ul>\r\n    </div>\r\n    <div>\r\n      总用时：{{timeGlobal}}\r\n    </div>\r\n    <div>\r\n      <span v-if=\"player===1\">黑棋思考中……</span>\r\n      <span v-else-if=\"player===2\">白棋思考中……</span>\r\n      <span>{{timeLocal}}秒</span>\r\n    </div>\r\n    <div v-if=\"msg\">\r\n      <p>{{msg}}</p>\r\n      <p><button @click=\"onGameRestart\">再玩一次</button></p>\r\n    </div>\r\n    <div v-show=\"isStartPanelShow\" class=\"start-panel\">\r\n      <div class=\"start-wrap\">\r\n        <p>\r\n          <label>\r\n            <input type=\"radio\" name=\"difficulty\" v-model=\"difficulty\" value=\"0\" /> 初级\r\n          </label>\r\n        </p>\r\n        <p>\r\n          <label>\r\n            <input type=\"radio\" name=\"difficulty\" v-model=\"difficulty\" value=\"1\" /> 中级\r\n          </label>\r\n        </p>\r\n        <p>\r\n          <label>\r\n            <input type=\"radio\" name=\"difficulty\" v-model=\"difficulty\" value=\"2\" /> 高级\r\n          </label>\r\n        </p>\r\n        <p>\r\n          <label>\r\n            <input type=\"radio\" name=\"difficulty\" v-model=\"difficulty\" value=\"10\" /> 双人对战\r\n          </label>\r\n        </p>\r\n        <button @click=\"onGameStart\">开始游戏</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as Reversi from \"./reversi/main\";\r\nexport default {\r\n  name: 'Game',\r\n  data() {\r\n    return {\r\n      isStartPanelShow: true,\r\n      difficulty: 0,\r\n      msg: \"\",\r\n      timeGlobal: 0,\r\n      timeLocal: 0,\r\n      player: 0,\r\n      black: 0,\r\n      white: 0\r\n    };\r\n  },\r\n  _time: 0,\r\n  _count: 0,\r\n  __reversi: null,\r\n  mounted() {\r\n    this.__reversi = new Reversi.main(this.$refs['game']);\r\n    this.__reversi.addEventListener(Reversi.EVENT.GAME_STEP, this.onGameStep);\r\n    this.__reversi.addEventListener(Reversi.EVENT.RUNNING, this.onGameRunning);\r\n    this.__reversi.addEventListener(Reversi.EVENT.GAME_OVER, this.onGameOver);\r\n  },\r\n  methods: {\r\n    onGameClick(e) {\r\n      this.__reversi.click(e);\r\n    },\r\n    onGameStart(e) {\r\n      this.isStartPanelShow = false;\r\n      this.__reversi.start(this.difficulty);\r\n      this._count = this._time || 0;\r\n    },\r\n    onGameRestart(e) {\r\n      this.__reversi.reset();\r\n      this.isStartPanelShow = true;\r\n      this.msg = \"\";\r\n    },\r\n    onGameOver(e) {\r\n      const { black, white, space } = e.data;\r\n      if (black > white) {\r\n        this.msg = \"黑棋胜\";\r\n      } else if (white > black) {\r\n        this.msg = \"白棋胜\";\r\n      } else {\r\n        this.msg = \"平局\";\r\n      }\r\n    },\r\n    onGameRunning(e) {\r\n      const time = e.data;\r\n      this._time = time;\r\n      const hour = Math.floor(time / (60 * 60));\r\n      const minute = Math.floor((time / 60) % 60);\r\n      const second = Math.floor(time % 60);\r\n      this.timeGlobal = `${hour}小时 ${minute}分 ${second}秒`;\r\n      this.timeLocal = Math.floor(this._time - this._count);\r\n      if(this.timeLocal < 0) this.timeLocal = 0;\r\n    },\r\n    onGameStep(e) {\r\n      this._count = this._time || 0;\r\n      this.black = e.data.black;\r\n      this.white = e.data.white;\r\n      this.player = e.data.player;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\nh3 {\r\n  margin: 40px 0 0;\r\n}\r\nul {\r\n  list-style-type: none;\r\n  padding: 0;\r\n}\r\nli {\r\n  display: inline-block;\r\n  margin: 0 10px;\r\n}\r\na {\r\n  color: #42b983;\r\n}\r\n.container {\r\n  max-width:500px;\r\n  width:100%\r\n}\r\n.start-panel {\r\n  width: 5rem;\r\n  position: absolute;\r\n  left: 1.25rem;\r\n  top: 1.75rem;\r\n  z-index: 1;\r\n  border-radius: 0.1rem;\r\n  background-color: white;\r\n}\r\n.start-panel .start-wrap {\r\n  margin: 0.3rem 1.5rem 0.7rem;\r\n}\r\n.start-panel .start-wrap p {\r\n  text-align: left;\r\n}\r\n</style>\r\n","import { Mesh, BoxGeometry, MeshBasicMaterial, TextureLoader } from 'three';\r\nimport image from './textures/square.jpg';\r\n/**\r\n *\t方块\r\n */\r\nconst Square = function() {\r\n  const _this = this;\r\n  _this.row = NaN; // 方块行，也就是y坐标\r\n  _this.col = NaN; // 方块列，也就是x坐标\r\n\t/**\r\n\t *\t初始化\r\n\t */\r\n\t_this.init = () => {\r\n    const g = new BoxGeometry(Square.WIDTH, Square.HEIGHT, Square.WIDTH); // 创建立方体\r\n    const t = new TextureLoader().load(image); // 读取纹理图片\r\n    const m = new MeshBasicMaterial( { color: 0xffaa00, map: t } ); // 设置材质颜色为橙色，并添加纹理\r\n    Mesh.call(_this, g, m); // 超类\r\n  };\r\n  _this.blink = () => {\r\n    _this.position.y += 5;\r\n  };\r\n\t_this.init();\r\n};\r\n\r\nSquare.WIDTH = 10; // 棋盘方块边长\r\nSquare.HEIGHT = 2; // 棋盘方块高\r\n\r\nSquare.prototype = Object.create( Mesh.prototype );\r\nSquare.prototype.constructor = Square;\r\nexport default Square;","import { EventDispatcher } from 'three';\r\n/**\r\n *\t引擎\r\n */\r\nconst Engine = function(param) {\r\n  const _this = this;\r\n  let _data = null; // 棋盘数据\r\n  let _current = null; // 行动者\r\n  /**\r\n   *\t初始化\r\n   */\r\n  _this.init = function(data) {\r\n    if (data) {\r\n      _data = [];\r\n      for(let m = 0; m < Engine.ROW; m++) {\r\n        const arr = [];\r\n        for(let n = 0; n < Engine.COL; n++) {\r\n          arr.push(data[m][n]);\r\n        }\r\n        _data.push(arr);\r\n      }\r\n    } else {\r\n      _this.reset();\r\n    }\r\n  };\r\n  /**\r\n   * 克隆\r\n   * @returns {Engine} 新的引擎\r\n   */\r\n  _this.clone = () => new Engine(_data);\r\n  /**\r\n   * 复位\r\n   */\r\n  _this.reset = () => {\r\n    _data = [];\r\n    for(let m = 0; m < Engine.ROW; m++) {\r\n      const arr = [];\r\n      for(let n = 0; n < Engine.COL; n++) {\r\n        arr.push(0);\r\n      }\r\n      _data.push(arr);\r\n    }\r\n    _current = null;\r\n  };\r\n  /**\r\n   * 开始游戏\r\n   */\r\n  _this.start = () => {\r\n    const arr = [];\r\n    arr.push({row: 3, col: 4, color: Engine.CHESS.BLACK});\r\n    arr.push({row: 3, col: 3, color: Engine.CHESS.WHITE});\r\n    arr.push({row: 4, col: 3, color: Engine.CHESS.BLACK});\r\n    arr.push({row: 4, col: 4, color: Engine.CHESS.WHITE});\r\n    for(const obj of arr) {\r\n      const { row, col, color } = obj;\r\n      _data[row][col] = color;\r\n    }\r\n    shiftPlayer();\r\n    const data = {\r\n      moves: arr,\r\n      count: getCount()\r\n    };\r\n    const e = { type: Engine.EVENT.START, data };\r\n    _this.dispatchEvent(e);\r\n  };\r\n  /**\r\n   * 获取数据\r\n   */\r\n  _this.getData = () => {\r\n    return _data;\r\n  };\r\n  /**\r\n   * 换下一个颜色下棋\r\n   */\r\n  function shiftPlayer() {\r\n    if(!_current) {\r\n      _current = Engine.CHESS.BLACK;\r\n    } else {\r\n      _current = _current === Engine.CHESS.BLACK ? Engine.CHESS.WHITE : Engine.CHESS.BLACK;\r\n    }\r\n    const e = { type: Engine.EVENT.SHIFT, data: _current };\r\n    _this.dispatchEvent(e);\r\n    const legal = _this.getLegal(_current);\r\n    if(legal.length === 0) return shiftPlayer();\r\n    return _current;\r\n  }\r\n  /**\r\n   * 获得当前棋手\r\n   */\r\n  _this.getPlayer = () => _current;\r\n  /**\r\n   * 获取结果\r\n   */\r\n  _this.getResult = () => {\r\n    const count = getCount();\r\n    const diff = count.black - count.white;\r\n    let winner = Engine.WINNER.DRAW;\r\n    if(diff > 0) {\r\n      winner = Engine.WINNER.BLACK;\r\n    } else if(diff < 0) {\r\n      winner = Engine.WINNER.WHITE;\r\n    }\r\n    return { count, winner, diff };\r\n  };\r\n  /**\r\n   * 游戏检测\r\n   * @returns {boolean} 是否继续进行\r\n   */\r\n  _this.isGameOver = () => {\r\n    const count = getCount();\r\n    if (count.space === 0 || count.black === 0 || count.white === 0) {\r\n      const event = { type: Engine.EVENT.GAME_OVER, data: count};\r\n      _this.dispatchEvent(event);\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  };\r\n  /**\r\n   * 走棋\r\n   * @param {int} row 行\r\n   * @param {int} col 列\r\n   */\r\n  _this.move = (row, col) => {\r\n    const color = _current;\r\n    let flips  = getFilp(row, col, color);\r\n    if(flips) { // 有可以反转的地方棋子才可落子\r\n      for(const obj of flips) {\r\n        _data[obj.row][obj.col] = color;\r\n      }\r\n    } else {\r\n      return;\r\n    }\r\n    _data[row][col] = color; // 落子\r\n    const count = getCount();\r\n    const data = { row, col, color, flips, count };\r\n    const e = { type: Engine.EVENT.MOVE, data };\r\n    _this.dispatchEvent(e); // 走棋事件\r\n    if(_this.isGameOver()) return;\r\n    shiftPlayer();\r\n  };\r\n  /**\r\n   * 获得可以翻的棋\r\n   * @param {int} row 行\r\n   * @param {int} col 列\r\n   * @param {int} color 颜色\r\n   * @returns {Array} 可反转的位置\r\n   */\r\n  function getFilp(row, col, color) {\r\n    if (_data[row][col] !== 0) { // 所在位置必须可以落子\r\n      return false;\r\n    }\r\n    if (!isValid(col, row)) { // 坐标在棋盘上\r\n      return false;\r\n    }\r\n    _data[row][col] = color; // 落子\r\n    const arr = [];\r\n    const opColor = color === Engine.CHESS.BLACK ? Engine.CHESS.WHITE : Engine.CHESS.BLACK; // 获取对手棋子颜色\r\n    const direction = [[0, 1], [1, 1], [1, 0], [1, -1], [0, -1], [-1, -1], [-1, 0], [-1, 1]]; // 横纵斜8个方向\r\n    for(const coord of direction) {\r\n      const [ xdirection, ydirection ] = coord;\r\n      let x = parseInt(col);\r\n      let y = parseInt(row);\r\n      do {\r\n        x += xdirection;\r\n        y += ydirection;\r\n      } while(isValid(y, x) && _data[y][x] === opColor); // 横纵或者斜线一个方向一直找到不是对方颜色或者不在棋盘上\r\n      if(!isValid(y, x)) continue; // 超出棋盘直接跳出\r\n      if(_data[y][x] === color) { // 如果最后停止的颜色是自己的棋子颜色，过程中的对手棋子都为反转棋子\r\n        while (isValid(y, x)) {\r\n          x -= xdirection;\r\n          y -= ydirection;\r\n          if (y == parseInt(row) && x == parseInt(col)) break; // 回到之前落子跳出\r\n          arr.push({col:x, row:y}); // 两子之间敌方棋子存入数组\r\n        }\r\n      }\r\n    }\r\n    _data[row][col] = 0; // 还原落子之前状态，因为很多需要判断可以落子而不是直接落子\r\n    if(arr.length === 0) return false;\r\n    return arr;\r\n  }\r\n  /**\r\n   * 获取合法点\r\n   * @param {emun} color 棋色\r\n   */\r\n  _this.getLegal = (color) => {\r\n    if(isNaN(color)) color = _current;\r\n    const direction = [[-1, 0], [-1, 1], [0, 1], [1, 1], [1, 0], [1, -1], [0, -1], [-1, -1]];\r\n    const opColor = color === Engine.CHESS.BLACK ? Engine.CHESS.WHITE : Engine.CHESS.BLACK;\r\n    const nears = [];\r\n    for(const m in _data) {\r\n      for(const n in _data[m]) {\r\n        if(_data[m][n] === opColor) { // 遍历所有对手棋子\r\n          for(const coord of direction) {\r\n            const [ dx, dy ] = coord;\r\n            let x = parseInt(n) + dx;\r\n            let y = parseInt(m) + dy;\r\n            if(isValid(y, x) && _data[y][x]=== Engine.CHESS.NONE // 找到对手棋子横纵斜八个方向没有任何落子的坐标\r\n            && nears.findIndex(k => k[0] === x && k[1] === y) === -1) { // 去除重复坐标\r\n              nears.push([x, y]);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    const arr = [];\r\n    for(const coord of nears) {\r\n      if(getFilp(coord[1], coord[0], color)) { // 可以反转即存入数组\r\n        arr.push(coord);\r\n      }\r\n    }\r\n    return arr;\r\n  };\r\n  /**\r\n   * 在棋盘上\r\n   * @param {int} row 行\r\n   * @param {int} col 列\r\n   * @returns {Boolean} 是否在棋盘上\r\n   */\r\n  function isValid( row, col ) {\r\n    return (row >= 0 && row <= Engine.ROW - 1 && col >= 0 && col <= Engine.COL - 1);\r\n  }\r\n  /**\r\n   * 获取统计\r\n   */\r\n  function getCount() {\r\n    const counter = {\r\n      black: 0,\r\n      white: 0,\r\n      space: 0\r\n    };\r\n    for(const row of _data) {\r\n      for(const col of row) {\r\n        if(col === Engine.CHESS.BLACK) {\r\n          counter.black++;\r\n        } else if(col === Engine.CHESS.WHITE) {\r\n          counter.white++;\r\n        } else {\r\n          counter.space++;\r\n        }\r\n      }\r\n    }\r\n    return counter;\r\n  }\r\n  _this.init(param);\r\n};\r\nEngine.ROW = 8;\r\nEngine.COL = 8;\r\nEngine.CHESS = {\r\n  NONE: 0,  // 没有棋子\r\n  BLACK: 1, // 黑棋\r\n  WHITE: 2  // 白棋\r\n};\r\nEngine.WINNER = {\r\n  DRAW: 0,\r\n  BLACK: 1,\r\n  WHITE: 2\r\n};\r\nEngine.EVENT = {\r\n  START: \"gameStart\", // 游戏开始\r\n  GAME_OVER: \"gameOver\", // 游戏结束\r\n  MOVE: \"chessMove\", // 走棋\r\n  SHIFT: \"playerShift\", // 旗手交换\r\n  FLIP: \"chessFlip\" // 棋子翻转\r\n};\r\n\r\nObject.assign( Engine.prototype, EventDispatcher.prototype );\r\nEngine.prototype.constructor = Engine;\r\nexport default Engine;","import { Mesh, CylinderGeometry, MeshBasicMaterial } from 'three';\r\nimport { Tween, Easing } from '@tweenjs/tween.js';\r\nimport Engine from './engine';\r\n/**\r\n *\t棋子\r\n */\r\nconst Piece = function(param) {\r\n  const _this = this;\r\n  let _color = null; // 棋子颜色\r\n  /**\r\n   *\t初始化\r\n    */\r\n  _this.init = (color) => {\r\n    const geometry = new CylinderGeometry(Piece.RADIUS, Piece.RADIUS, Piece.WIDTH, Piece.SEGMENT);\r\n    const materials = [\r\n      new MeshBasicMaterial( { color: \"red\" } ), // 圆柱侧边\r\n      new MeshBasicMaterial( { color: \"black\" } ), // 圆柱顶\r\n      new MeshBasicMaterial( { color: \"white\" } ) // 圆柱底\r\n    ];\r\n    Mesh.call(_this, geometry, materials);\r\n    _color = parseInt(color);\r\n    if(_color == Engine.CHESS.WHITE) { // 根据颜色决定初始旋转度\r\n      _this.rotation.x = Math.PI; // 按照x轴旋转180度就是白子\r\n    }\r\n  };\r\n  /**\r\n   * 走棋\r\n   */\r\n  _this.move = () => {\r\n    return new Promise((resolve) => {\r\n      let coord = { y: 10 }; // 落子为y=10位置，到y=0位置的动画\r\n      const t = new Tween(coord).to({y:0}, 500).easing(Easing.Quadratic.In);\r\n      t.onUpdate((e) => {_this.position.y = e.y;});\r\n      t.onComplete(e => {resolve(e);});\r\n      t.start();\r\n    });\r\n  };\r\n  /**\r\n   * 翻转\r\n   * @param {int} delay 延迟\r\n   */\r\n  _this.flip = (delay = 0) => {\r\n    return new Promise((resolve) => {\r\n      let rotation = { x: 0 };\r\n      _color = _color == Engine.CHESS.WHITE ? Engine.CHESS.BLACK : Engine.CHESS.WHITE;\r\n      const initX = _this.rotation.x;\r\n      let coord = { y: 0 };\r\n      const up = new Tween(coord).to({y: 10}, 300).onUpdate((e) => {_this.position.y = e.y;}); // 升起动画\r\n      const down = new Tween(coord).to({y: 0}, 200).onUpdate((e) => {_this.position.y = e.y;}); // 下降动画\r\n      const spin = new Tween(rotation).to({x: Math.PI}, 300).onUpdate((e) => {_this.rotation.x = initX + e.x;}); // 旋转动画\r\n      spin.onComplete(e => {resolve(e);});\r\n      spin.chain(down); // 旋转跟下降链接\r\n      up.chain(spin); // 上升跟旋转链接\r\n      up.delay(delay);\r\n      up.start(); // 最终动画为：升起->旋转->落下\r\n    });\r\n  };\r\n\t_this.init(param);\r\n};\r\n\r\nPiece.RADIUS = 4; // 棋子半径\r\nPiece.HEIGHT = 1; // 棋子厚度\r\nPiece.SEGMENT = 20; // 棋子横断面，越大越圆\r\n\r\nPiece.prototype = Object.create( Mesh.prototype );\r\nPiece.prototype.constructor = Piece;\r\nexport default Piece;","import { Object3D } from 'three';\r\nimport Square from './square';\r\nimport Piece from './piece';\r\nimport { Tween, Easing } from '@tweenjs/tween.js';\r\n\r\n/**\r\n *\t棋盘\r\n */\r\nconst Board = function() {\r\n  const _this = this;\r\n  let __bg = null, // 背景层\r\n    __chess = null; // 棋子层\r\n  _this.offset = { // 偏移位置\r\n    row: 0,\r\n    col: 0,\r\n  };\r\n  /**\r\n   *\t初始化\r\n    */\r\n  _this.init = () => {\r\n    Object3D.call(_this);\r\n    __bg = new Object3D();\r\n    __chess = new Object3D();\r\n    _this.add(__bg, __chess);\r\n  };\r\n  /**\r\n   * 重置\r\n   */\r\n  _this.reset = () => {\r\n    __chess.clear();\r\n  };\r\n  /**\r\n   * 触碰\r\n   * @param {raycaster} raycaster 射线\r\n   */\r\n  _this.hit = raycaster => {\r\n    const intersects = raycaster.intersectObjects( __bg.children );\r\n    let ret = null;\r\n    if(intersects.length > 0) {\r\n      ret = intersects[0];\r\n    }\r\n    return ret;\r\n  };\r\n  /**\r\n   * 铺棋盘\r\n   * @param {Array} 棋盘二维数组\r\n   */\r\n  _this.pave = (data) => {\r\n    __bg.clear();\r\n    _this.offset.row = data.length / 2 * Square.WIDTH - Square.WIDTH / 2;\r\n    _this.offset.col = _this.offset.row;\r\n    for ( const m in data ) {\r\n      for ( const n in data[m] ) {\r\n        const square = new Square();\r\n        square.row = m;\r\n        square.col = n;\r\n        square.position.x = n * Square.WIDTH;\r\n        square.position.z = m * Square.WIDTH;\r\n        __bg.add(square);\r\n      }\r\n    }\r\n    __bg.position.set(-_this.offset.col, 0, -_this.offset.row);\r\n    __chess.position.set(-_this.offset.col, Square.HEIGHT, -_this.offset.row);\r\n  };\r\n  _this.pave2 = (data) => {\r\n    __bg.clear();\r\n    _this.offset.row = data.length / 2 * Square.WIDTH - Square.WIDTH / 2;\r\n    _this.offset.col = _this.offset.row;\r\n    let d = 1;\r\n    for ( const m in data ) {\r\n      for ( const n in data[m] ) {\r\n        const square = new Square();\r\n        square.row = m;\r\n        square.col = n;\r\n        square.position.x = n * Square.WIDTH;\r\n        square.position.z = m * Square.WIDTH;\r\n        square.visible = false;\r\n        let coord = { y: 100 };\r\n        const t = new Tween(coord).to({y:0}, 500).easing(Easing.Quadratic.In);\r\n        t.onUpdate((e) => {square.position.y = e.y;});\r\n        t.onStart(e => {square.visible = true;});\r\n        t.delay(d * 100);\r\n        t.start();\r\n        __bg.add(square);\r\n        d++;\r\n      }\r\n    }\r\n    __bg.position.set(-_this.offset.col, 0, -_this.offset.row);\r\n  };\r\n  /**\r\n   * 走棋\r\n   * @param {int} row 行\r\n   * @param {int} col 列\r\n   * @param {int} color 颜色\r\n   */\r\n  _this.move = (row, col, color) => {\r\n    const piece = new Piece(color);\r\n    piece.position.x = col * Square.WIDTH;\r\n    piece.position.z = row * Square.WIDTH;\r\n    piece.name = `${row}-${col}`;\r\n    __chess.add(piece);\r\n    return piece.move();\r\n  };\r\n  /**\r\n   * 翻转\r\n   * @param {array} arr \r\n   */\r\n  _this.flip = (arr) => {\r\n    const list = [];\r\n    if (arr) {\r\n      for(const k in arr) {\r\n        const { row, col } = arr[k];\r\n        const piece = __chess.getObjectByName(`${row}-${col}`);\r\n        list.push(piece.flip(parseInt(k) * 500));\r\n      }\r\n    }\r\n    return Promise.all(list);\r\n  };\r\n\t_this.init();\r\n};\r\n\r\nBoard.prototype = Object.create( Object3D.prototype );\r\nBoard.prototype.constructor = Board;\r\nexport default Board;","/**\r\n * Roxanne 策略 详见 《Analysis of Monte Carlo Techniques in Othello》 \r\n * 提出者：Canosa, R. Roxanne canosa homepage. https://www.cs.rit.edu/~rlc/ \r\n */\r\nclass Roxanne {\r\n  constructor() {\r\n    this._table = [ // 优先级\r\n      [ [0, 0], [0, 7], [7, 0], [7, 7] ],\r\n      [ [2, 2], [2, 5], [5, 2], [5, 5] ],\r\n      [ [3, 2], [3, 5], [4, 2], [4, 5], [2, 3], [2, 4], [5, 3], [5, 4] ],\r\n      [ [2, 0], [2, 7], [5, 0], [5, 7], [0, 2], [0, 5], [7, 2], [7, 5] ],\r\n      [ [3, 0], [3, 7], [4, 0], [4, 7], [0, 3], [0, 4], [7, 3], [7, 4] ],\r\n      [ [2, 1], [2, 6], [5, 1], [5, 6], [1, 2], [1, 5], [6, 2], [6, 5] ],\r\n      [ [3, 1], [3, 6], [4, 1], [4, 6], [1, 3], [1, 4], [6, 3], [6, 4] ],\r\n      [ [1, 1], [1, 6], [6, 1], [6, 6] ],\r\n      [ [1, 0], [1, 7], [6, 0], [6, 7], [0, 1], [0, 6], [7, 1], [7, 6]]\r\n    ];\r\n  }\r\n  select(arr) {\r\n    if (arr && arr.length > 0) {\r\n      for(const moves of this._table) { // 按照优先级遍历所有策略\r\n        moves.sort(() => 0.5 - Math.random()); // 随机排列该等级策略\r\n        for(const move of moves) {\r\n          if(arr.findIndex(n => n[0] === move[0] && n[1] === move[1]) > -1) { // 判断可下的位置是否在策略里\r\n            return move;\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n}\r\nexport default Roxanne;","import Engine from \"./engine\";\r\nimport Roxanne from \"./roxanne\";\r\n\r\n/**\r\n * 模拟器\r\n */\r\nclass Simulator {\r\n  /**\r\n   * 构造\r\n   * @param {Player} black 黑棋模拟选手\r\n   * @param {Player} white 白棋模拟选手\r\n   * @param {Engine} engine 引擎\r\n   * @param {int} current 现在棋手\r\n   */\r\n  constructor(black, white, engine, current) {\r\n    this.black = black;\r\n    this.white = white;\r\n    this.current = current;\r\n    this.engine = engine;\r\n  }\r\n  run() {\r\n    let n = 0;\r\n    while(!this.engine.isGameOver()) {\r\n      this.shift();\r\n      const arr = this.engine.getLegal(this.current.color);\r\n      if(arr && arr.length > 0) {\r\n        const action = this.current.getMove(arr);\r\n        this.engine.move(action[1], action[0]);  \r\n      }\r\n      if(n >100)\r\n        break;\r\n      else\r\n        n++;\r\n    }\r\n    return this.engine.getResult();\r\n  }\r\n  /**\r\n   * 设置current玩家\r\n   */\r\n  shift() {\r\n    const color = this.engine.getPlayer();\r\n    if(isNaN(color)) {\r\n      this.current = this.black;\r\n    } else {\r\n      this.current = color === Engine.CHESS.BLACK ? this.black : this.white;\r\n    }\r\n    return this.current;\r\n  }\r\n}\r\n/**\r\n * 模拟玩家\r\n * @param {int} color 颜色\r\n */\r\nclass SimulatePlayer {\r\n  /**\r\n   * \r\n   * @param {enum} color 颜色\r\n   * @param {enum} type 类型\r\n   */\r\n  constructor(color, type) {\r\n    this.color = color;\r\n    this.type = type;\r\n    this.roxnane = new Roxanne();\r\n  }\r\n  /**\r\n   * 走棋\r\n   * @param {Array} arr 可以走的位置\r\n   * @returns 走棋步骤[col, row]\r\n   */\r\n  getMove(arr) {\r\n    return this.roxnane.select(arr);\r\n  }\r\n}\r\n/**\r\n * 梦特卡洛树\r\n */\r\nclass TreeNode {\r\n  constructor(parent, color) {\r\n    this.parent = parent;\r\n    this.w = 0;\r\n    this.n = 0;\r\n    this.row = NaN;\r\n    this.col = NaN;\r\n    this.color = color;\r\n    this.children = [];\r\n  }\r\n  /**\r\n   * 设置走棋步骤\r\n   * @param {array} move [col, row]\r\n   */\r\n  setMove(move) {\r\n    this.row = move[1];\r\n    this.col = move[0];\r\n  }\r\n  /**\r\n   * 获得走棋步骤\r\n   */\r\n  getMove() {\r\n    return [this.col, this.row];\r\n  }\r\n  /**\r\n   * 添加节点，去重\r\n   * @param {TreeNode} node 蒙特卡洛树节点\r\n   */\r\n  add(node) {\r\n    if(this.children.findIndex(p => p.row === node.row && p.col === node.col) === -1) {\r\n      this.children.push(node);\r\n    }\r\n  }\r\n}\r\n/**\r\n * 梦特卡洛算法\r\n * @param {int} color 颜色\r\n * @param {int} expire 限时\r\n */\r\nclass MonteCarlo {\r\n  constructor(color, expire = 2000) {\r\n    this.color = color;\r\n    this.expire = expire;\r\n    this.tick = 0;\r\n    this.black = new SimulatePlayer(Engine.CHESS.BLACK);\r\n    this.white = new SimulatePlayer(Engine.CHESS.WHITE);\r\n  }\r\n  /**\r\n   * 运行\r\n   * @param {Engine} engine 引擎\r\n   */\r\n  run(engine) {\r\n    this.tick = new Date().getTime();\r\n    const root = new TreeNode(null, this.color);\r\n    return new Promise((resolve, reject) => {\r\n      const sid = setInterval(() => {\r\n        const simulateEngine = engine.clone();\r\n        const choice = this.select(root, simulateEngine);\r\n        this.expand(choice, simulateEngine);\r\n        const {winner} = this.simulate(choice, simulateEngine);\r\n        let backScore = [0.5, 1, 0][winner];\r\n        if (choice.color === Engine.CHESS.BLACK) {\r\n          backScore = 1 - backScore;\r\n        }\r\n        this.backProp(choice, backScore);\r\n        if(new Date().getTime() - this.tick > this.expire - 1) {\r\n          clearInterval(sid);\r\n          let bestN = -1;\r\n          let bestMove = null;\r\n          for(const k in root.children) {\r\n            if(root.children[k].n > bestN) {\r\n              bestN = root.children[k].n;\r\n              bestMove = root.children[k].getMove();\r\n            }\r\n          }      \r\n          resolve(bestMove);\r\n        }\r\n      }, 1);\r\n  \r\n    });\r\n  }\r\n  /**\r\n   * 蒙特卡洛树搜索，节点选择\r\n   * @param {TreeNode} node 节点\r\n   * @param {Engine} engine 引擎\r\n   * @returns 搜索树向下递归选择子节点\r\n   */\r\n  select(node, engine) {\r\n    if (node.children.length === 0) {\r\n      return node;\r\n    } else {\r\n      let bestScore = -1;\r\n      let bestMove = null;\r\n      for (const k in node.children) {\r\n        if (node.children[k].n === 0) {\r\n          bestMove = k;\r\n          break;\r\n        } else {\r\n          let N = node.n;\r\n          let n = node.children[k].n;\r\n          let w = node.children[k].w;\r\n          const score = w / n + Math.sqrt(2 * Math.log(N) / n);\r\n          if (score > bestScore) {\r\n            bestScore = score;\r\n            bestMove = k;\r\n          }\r\n        }\r\n      }\r\n      return this.select(node.children[bestMove], engine);\r\n    }\r\n  }\r\n  /**\r\n   * 蒙特卡洛树搜索，节点扩展\r\n   * @param {TreeNode} node 节点\r\n   * @param {Engine} engine 引擎\r\n   * @returns 搜索树向下递归选择子节点\r\n   */\r\n  expand(node, engine) {\r\n    for (const move of engine.getLegal(node.color)) {\r\n      const child = new TreeNode(node, node.color);\r\n      child.setMove(move);\r\n      node.add(child);\r\n    }\r\n  }\r\n  /**\r\n   * 蒙特卡洛树搜索，采用Roxanne策略代替随机策略搜索，模拟扩展搜索树\r\n   * @param {TreeNode} node 节点\r\n   * @param {Engine} engine 引擎\r\n   */\r\n  simulate(node, engine) {\r\n    const current = node.color === Engine.CHESS.WHITE ? Engine.CHESS.BLACK : Engine.CHESS.WHITE;\r\n    const simulator = new Simulator(this.black, this.white, engine, current);\r\n    return simulator.run();\r\n  }\r\n  /**\r\n   * 蒙特卡洛树搜索，反向传播，回溯更新模拟路径中的节点奖励\r\n   * @param {TreeNode} node 节点\r\n   * @param {int} score 计分\r\n   */\r\n  backProp(node, score) {\r\n    node.n += 1;\r\n    node.w += score;\r\n    if (node.parent) {\r\n      this.backProp(node.parent, 1 - score);\r\n    } \r\n  }\r\n  /**\r\n   * 蒙特卡洛树搜索\r\n   * @param {Engine} engine 引擎\r\n   * @returns 采取最佳拓展落子策略\r\n   */\r\n  getMove(engine) {\r\n    this.tick = new Date().getTime();\r\n    const action = this.mcts(engine.clone());\r\n    return action;\r\n  }\r\n}\r\nexport default MonteCarlo;","import { EventDispatcher } from 'three';\r\nimport Engine from './engine';\r\nimport MonteCarlo from './monte-carlo';\r\nimport Roxanne from './roxanne';\r\n\r\n/**\r\n *\t电脑玩家\r\n */\r\nconst AIPlayer = function(level) {\r\n  const _this = this;\r\n  let _mcts = null;\r\n  let _roxnane = null;\r\n  let _level = 0; // 游戏等级\r\n\t/**\r\n\t *\t初始化\r\n\t */\r\n\t_this.init = (lv) => {\r\n    _mcts = new MonteCarlo(Engine.CHESS.WHITE);\r\n    _roxnane = new Roxanne();\r\n    _level = parseInt(lv);\r\n  };\r\n  /**\r\n   * 获取棋色\r\n   */\r\n  _this.getColor = () => {\r\n    return Engine.CHESS.WHITE;\r\n  };\r\n  /**\r\n   * 思考\r\n   * @param {Engine} engine 引擎\r\n   */\r\n  _this.think = (engine) => {\r\n    if(_level === 2) {\r\n      _mcts.run(engine).then(res => {\r\n        const [ col, row ] = res;\r\n        const data = { col, row, color: _this.getColor() };\r\n        const e = { type: AIPlayer.EVENT.MOVE, data };\r\n        _this.dispatchEvent(e);\r\n      });\r\n    } else {\r\n      const arr = engine.getLegal();\r\n      if(arr.length === 0) return;\r\n      let col, row;\r\n      if(_level === 1) {\r\n        [ col, row ] = _roxnane.select(arr);\r\n      } else {\r\n        [ col, row ] = arr[parseInt(Math.random() * arr.length)];\r\n      }\r\n      const data = { col, row, color: _this.getColor() };\r\n      setTimeout(() => {\r\n        const e = { type: AIPlayer.EVENT.MOVE, data };\r\n        _this.dispatchEvent(e);        \r\n      }, 500);  \r\n    }\r\n  };\r\n\t_this.init(level);\r\n};\r\n\r\nAIPlayer.EVENT = {\r\n  MOVE: \"aiPlayerMove\"\r\n};\r\n\r\n\r\nAIPlayer.prototype = Object.create( EventDispatcher.prototype );\r\nAIPlayer.prototype.constructor = AIPlayer;\r\nexport default AIPlayer;","import { WebGLRenderer, EventDispatcher, PerspectiveCamera, Scene, Color, Raycaster, Vector2, Vector3, Clock } from 'three';\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\r\nimport TWEEN, { Tween } from '@tweenjs/tween.js';\r\nimport Board from './board';\r\nimport Engine from './engine';\r\nimport AIPlayer from './ai-player';\r\nimport Square from './square';\r\nimport Piece from './piece';\r\n/**\r\n *\t版本\r\n */\r\nconst VER = \"1.0\";\r\n/**\r\n *\t事件\r\n */\r\nconst EVENT = {\r\n  RUNNING:\t\"running\",\r\n  GAME_INIT: \"gameInit\",\r\n  GAME_START:\t\"gameStart\",\r\n  GAME_STEP: \"gameStep\",\r\n  GAME_OVER:\t\"gameOver\"\r\n};\r\n/**\r\n * 主函数\r\n * @param {canvas} container canvas元素\r\n */\r\nconst main = function(container){\r\n  const _this = this;\r\n  \r\n  let X = 0,\r\n    Y = 0,\r\n    WIDTH = 0,\r\n    HEIGHT = 0;\r\n  let _canvas = null;\r\n  \r\n  const CAMERA_FAR = 60; // 摄像头距离\r\n  let __camera = null,\t//摄像头\r\n    __scene = null,\t//场景\r\n    __renderer = null,\t//渲染器\r\n    __board = null;\t//棋盘\r\n  let _raycaster = null, // 射线\r\n    _engine = null, // 游戏引擎\r\n    _situation = {}, // 对阵局势\r\n    _ai = null, // 电脑玩家\r\n    _clock = new Clock, // 时钟\r\n    _running = false, // 游戏运行中\r\n    _enable = false; // 激活状态\r\n  /**\r\n   *\t初始化\r\n   */\r\n  _this.init = function(canvas) {\r\n    _canvas = canvas;\r\n    onResize();\r\n    __scene = new Scene();\r\n    __scene.background = new Color( 'skyblue' );\r\n    __camera = new PerspectiveCamera( 75, WIDTH / HEIGHT, 1, 1000 );\r\n    __camera.position.set(0, 0, CAMERA_FAR);\r\n    __renderer = new WebGLRenderer({canvas, antialias: true});\r\n    _raycaster = new Raycaster();\r\n    _engine = new Engine();\r\n    _engine.addEventListener( Engine.EVENT.START, onChessStart );\r\n    _engine.addEventListener( Engine.EVENT.GAME_OVER, onGameOver );\r\n    _engine.addEventListener( Engine.EVENT.MOVE, onChessMove );\r\n    __board = new Board();\r\n    __board.pave(_engine.getData());\r\n    __scene.add( __board );\r\n    __camera.lookAt(__board.position);\r\n    window.addEventListener(\"resize\", onResize);\r\n    animate(0);\r\n  };\r\n  /**\r\n   * 尺寸重置\r\n   */\r\n  function onResize() {\r\n    X = _canvas.offsetLeft;\r\n    Y = _canvas.offsetTop;\r\n    WIDTH = _canvas.clientWidth;\r\n    HEIGHT = _canvas.clientHeight;\r\n  }\r\n  /**\r\n   * 重置\r\n   */\r\n  _this.reset = () => {\r\n    _engine.reset();\r\n    __board.reset();\r\n    _enable = false;\r\n    _running = false;\r\n    TWEEN.removeAll();\r\n  };\r\n  /**\r\n   * 游戏开始\r\n   * @param {int} level 电脑等级\r\n   */\r\n  _this.start = (level) => {\r\n    onResize(); // 必须重新定位，否则高度不正确\r\n    let v = new Vector3();\r\n    v.copy(__camera.position);\r\n    const motion = new Vector3();\r\n    const t = new Tween(v).to({x: 0, y: CAMERA_FAR, z: 0}); // 摄像机动画\r\n    t.onUpdate(e => {\r\n      motion.copy(e);\r\n      motion.setLength(CAMERA_FAR);\r\n      __camera.position.copy(motion);\r\n      __camera.lookAt(__board.position);\r\n    });\r\n    t.onComplete(() => {\r\n      if(parseInt(level ) === 10) {\r\n        _situation[Engine.CHESS.WHITE] = 'player';\r\n      }else{\r\n        _ai = new AIPlayer(level);\r\n        _ai.addEventListener( AIPlayer.EVENT.MOVE, onAIMove );  \r\n        _situation[Engine.CHESS.WHITE] = 'ai';\r\n      }\r\n      _situation[Engine.CHESS.BLACK] = 'player';\r\n      _engine.start();\r\n    });\r\n    t.start();\r\n  };\r\n  _this.test = () => {\r\n    __scene.clear();\r\n    const t = new Piece()\r\n    __scene.add( t );\r\n    const controls = new OrbitControls(__camera, __renderer.domElement);\r\n    controls.update();\r\n  }\r\n  /**\r\n   * 点击\r\n   * @param {event} e\r\n   */\r\n  _this.click = (e) => {\r\n    if (!_enable) return; // 允许玩家走时候才能操作\r\n    const vec = new Vector2();\r\n    const x = e.x - X;\r\n    const y = e.y - Y;\r\n    vec.x = ( x / WIDTH ) * 2 - 1;\r\n    vec.y = - ( y / HEIGHT ) * 2 + 1;\r\n    _raycaster.setFromCamera( vec, __camera ); // 根据摄像头引射线\r\n    const ret = __board.hit(_raycaster); // 射线触碰决定用户点击的位置\r\n    if (ret) { // 玩家走棋\r\n      const { row, col } = ret.object;\r\n      _engine.move(row, col);\r\n    }\r\n  };\r\n  /**\r\n   * 交换操作者\r\n   */\r\n  function shiftPlayer() {\r\n    const current = _engine.getPlayer();\r\n    if (_situation[current] === \"player\") {\r\n      _enable = true;\r\n    } else if (_situation[current] === \"ai\") {\r\n      _ai.think(_engine);\r\n    }\r\n  }\r\n  /**\r\n   * 游戏开始\r\n   * @param {event} e \r\n   */\r\n  async function onChessStart(e) {\r\n    const { count, moves } = e.data;\r\n    const start = new Date().getTime();\r\n    for(const obj of moves) {\r\n      const { row, col, color } = obj;\r\n      await __board.move(row, col, color);\r\n    }\r\n    _enable = true;\r\n    _running = true;\r\n    _clock.start();\r\n    count.player = _engine.getPlayer();\r\n    const event = { type: EVENT.GAME_STEP, data: count};\r\n    _this.dispatchEvent(event);\r\n  }\r\n  /**\r\n   * 游戏结束\r\n   * @param {event} e \r\n   */\r\n  function onGameOver(e) {\r\n    _running = false;\r\n    _clock.stop();\r\n  }\r\n  /**\r\n   * 游戏检测\r\n   * @param {object} count 统计信息\r\n   * @returns {boolean} 是否继续进行\r\n   */\r\n  function gameOver(count) {\r\n    const event = { type: EVENT.GAME_OVER, data: count};\r\n    _this.dispatchEvent(event);\r\n  }\r\n  /**\r\n   * 走棋\r\n   * @param {event} e \r\n   */\r\n  function onChessMove(e) {\r\n    _enable = false;\r\n    const { row, col, color, flips, count } = e.data;\r\n    __board.move( row, col, color ).then(() => {\r\n      __board.flip(flips).then(() => {\r\n        count.player = _engine.getPlayer();\r\n        const event = { type: EVENT.GAME_STEP, data: count};\r\n        _this.dispatchEvent(event);\r\n        if(_running) {\r\n          shiftPlayer(); // 交换棋手\r\n        } else {\r\n          gameOver(count);\r\n        }\r\n      });\r\n    });\r\n  }\r\n  /**\r\n   * 电脑走棋\r\n   * @param {event} e \r\n   */\r\n  function onAIMove(e) {\r\n    const { row, col } = e.data;\r\n    _engine.move(row, col);\r\n  }\r\n  function animate(time) {\r\n    requestAnimationFrame( animate );\r\n    if(_running) {\r\n      const event = { type: EVENT.RUNNING, data: _clock.getElapsedTime()};\r\n      _this.dispatchEvent(event);\r\n    }\r\n    TWEEN.update(time);\r\n    __renderer.render( __scene, __camera );\r\n  }\r\n  _this.init(container);\r\n};\r\n\r\nObject.assign( main.prototype, EventDispatcher.prototype);\r\nmain.prototype.constructor = main;\r\nexport {main, VER, EVENT};","import { render } from \"./game.vue?vue&type=template&id=4f0d16f2&scoped=true\"\nimport script from \"./game.vue?vue&type=script&lang=js\"\nexport * from \"./game.vue?vue&type=script&lang=js\"\n\nimport \"./game.vue?vue&type=style&index=0&id=4f0d16f2&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\thales\\\\ucas\\\\reversi-web\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4f0d16f2\"]])\n\nexport default __exports__","import { render } from \"./app.vue?vue&type=template&id=71563f97\"\nimport script from \"./app.vue?vue&type=script&lang=js\"\nexport * from \"./app.vue?vue&type=script&lang=js\"\n\nimport \"./app.vue?vue&type=style&index=0&id=71563f97&lang=css\"\n\nimport exportComponent from \"D:\\\\thales\\\\ucas\\\\reversi-web\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue';\r\nimport App from './app.vue';\r\n\r\ncreateApp(App).mount('#app');\r\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"#app{font-family:Avenir,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-align:center;color:#2c3e50}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./game.vue?vue&type=style&index=0&id=4f0d16f2&scoped=true&lang=css\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"h3[data-v-4f0d16f2]{margin:40px 0 0}ul[data-v-4f0d16f2]{list-style-type:none;padding:0}li[data-v-4f0d16f2]{display:inline-block;margin:0 10px}a[data-v-4f0d16f2]{color:#42b983}.container[data-v-4f0d16f2]{max-width:500px;width:100%}.start-panel[data-v-4f0d16f2]{width:5rem;position:absolute;left:1.25rem;top:1.75rem;z-index:1;border-radius:.1rem;background-color:#fff}.start-panel .start-wrap[data-v-4f0d16f2]{margin:.3rem 1.5rem .7rem}.start-panel .start-wrap p[data-v-4f0d16f2]{text-align:left}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","export * from \"-!../node_modules/vue-style-loader/index.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./app.vue?vue&type=style&index=0&id=71563f97&lang=css\"","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./app.vue?vue&type=style&index=0&id=71563f97&lang=css\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"a60ab22a\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"sourceRoot":""}